<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Monochrome</title>
    <link rel="stylesheet" type="text/css" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./style.css">
    <!--Script Imports-->
    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

    <script type="text/javascript" src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="./node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script type="text/javascript" src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    <script>if (window.module) module = window.module;</script>

    <script type="text/javascript" src="./customelements.js"></script>
    <!--End Script Imports-->
    <script>
      // You can also require other files to run in this process
      const renderer = require('./renderer.js')
    </script>
  </head>
  <body id="body">


    <div id="container" class="container-fluid">
      <div class="row">
        <div id="sidebar" class="col-3#">
          <!--Sidebar-->
          <!--Accordion-->
          <div class="panel-group" id="accordion">
            <!--Contrast-->
            <div class="panel panel-default">
              <div class="panel-heading" id="topHeading">
                <h4 class="panel-title" data-toggle="collapse" data-parent="#accordion" href="#collapse1">
                  <a class="accordionheader">Contrast</a>
                </h4>
              </div>
              <div id="collapse1" class="panel-collapse collapse">
                <div class="panel-body">
                  <prop-slider id="slider_r" type="Contrast" min="-255" max="255" step="0.1" initvalue="0" value="0.0"></prop-slider>
                </div>
              </div>
            </div>
            <!--End Contrast-->
            <!--Add Brightness-->
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title" data-toggle="collapse" data-parent="#accordion" href="#collapse2">
                  <a class="accordionheader">Multiplicative Brightness</a>
                </h4>
              </div>
              <div id="collapse2" class="panel-collapse collapse">
                <div class="panel-body">
                  <prop-slider id="slider_g" type="Brightness" min="0" max="2" step="0.01" initvalue="1" value="0.0"></prop-slider>
                </div>
              </div>
            </div>
            <!--End Add Brightness-->
            <!--Mult Brightness-->
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title" data-toggle="collapse" data-parent="#accordion" href="#collapse3">
                  <a class="accordionheader">Additive Brightness</a>
                </h4>
              </div>
              <div id="collapse3" class="panel-collapse collapse">
                <div class="panel-body">
                  <prop-slider id="slider_b" type="Brightness" min="-1" max="1" step="0.01" initvalue="0" value="0.0"></prop-slider>
                </div>
              </div>
            </div>
            <!--End Mult Brightness-->
          </div>
          <!--End Accordion-->



              <br><br>
              <button type="button" class="btn btn-default" onclick="saveImageDialog();">Save</button>
              <button type="button" class="btn btn-default" onclick="openImageDialog();">Open</button>
              <br><br>
              <div class="btn-group btn-group-sm">
                <button type="button" class="btn btn-default" data-toggle="popover" data-content="Shows the input image without any effects"
                        onclick="setUnedited(true);" oncontextmenu="setElementPopover(this,true);">Unedited</button>

                <button type="button" class="btn btn-default" onclick="setUnedited(false);">Edited</button>
              </div>
              <br><br>
              <div class="btn-group btn-group-sm">
                <button type="button" class="btn btn-default" data-toggle="popover" data-content="Uses normal color information"
                        onclick="setColor(true);" oncontextmenu="setElementPopover(this,true);">Color</button>

                <button type="button" class="btn btn-default" data-toggle="popover" data-content="Uses black and white conversion"
                        onclick="setColor(false);" oncontextmenu="setElementPopover(this,true);">Monochrome</button>
              </div>

              <!--End Sidebar-->
        </div>
        <div id="mainwindow" class="col-9">
          <!--Main Window-->
          <div class="page-header">
            <h1 class="text-capitalize">Monochrome</h1>
          </div>

          <canvas id="canvas"></canvas>
          <!--End Main Window-->

        </div>
      </div>
    </div>

    <script>
      //Init Popovers
      $(document).ready(function(){
        $('[data-toggle="popover"]').popover({
          placement: 'top',
          trigger: 'manual'
        })
        //Initialize Slider Labels
        updateImage(true);
      });



      function setElementPopover(elm, value, delay = 2800){
        if(value == true){
          $(elm).popover('show');
          setTimeout(function(){setElementPopover(elm, false);},delay);
        }else{
          $(elm).popover('hide');
        }
      }

      function openImageDialog(){
        renderer.openImageDialog();
      }

      function saveImageDialog(){
        renderer.saveImageDialog();
      }

      function setUnedited(value){
        renderer.setUnedited(value);
        updateImage(false);
      }

      function setColor(value){
        renderer.setColor(value);
        updateImage(false);
      }

      function updateImage(askTime){
          //document.getElementById('lbl_rvalue').innerHTML = "" + document.getElementById('slider_r').value;
          //document.getElementById('lbl_gvalue').innerHTML = "Mult. Brightness: " + document.getElementById('slider_g').value;
          //document.getElementById('lbl_bvalue').innerHTML = "Add. Brightness: " + document.getElementById('slider_b').value;
          renderer.updateImage(askTime);
      }

      function saveImage(filename){
          renderer.saveImage(filename);
      }

      //Init Sliders
      updateImage(false);

    </script>
  </body>
</html>
